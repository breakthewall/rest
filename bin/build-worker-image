#!/bin/bash

app=$1
branch=$2
from_image=$3

if [[ "$app" == "" ]]; then
  echo
  echo "Usage:"
  echo
  echo "   `basename $0` <app-name> [nb_of_workers]"
  echo
  exit 1
fi

if [[ "$from_image" == "" ]]; then
  from_image=$app
fi

COMPOSE_PROJECT_NAME=${app}_${branch} \
BASE_IMAGE=$from_image \
REDIS="" \
NETWORK=$app \
docker-compose -f docker-compose-worker.yml build worker
